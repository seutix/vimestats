<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary: #3498db;
            --primary-hover: #2980b9;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --light-gray: #bdc3c7;
        }
        
        body {
            font-family: 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }
        
        h1 {
            color: var(--dark);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 300;
            font-size: 2.2rem;
        }
        
        /* Основной контент */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Сайдбар */
        .side-menu {
            position: fixed;
            left: -320px;
            top: 0;
            width: 300px;
            height: 100%;
            background-color: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease-in-out;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
        }
        
        .side-menu.active {
            left: 0;
        }
        
        .menu-toggle {
            position: fixed;
            left: 20px;
            top: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 90;
            background-color: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .menu-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .menu-toggle.active {
            transform: translateX(300px);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 95;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .menu-tabs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .menu-tab {
            padding: 12px 15px;
            background-color: var(--light);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .menu-tab:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .menu-tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .menu-content {
            display: none;
        }
        
        .menu-content.active {
            display: block;
        }
        
        .search-container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .search-container:hover {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .search-form {
            display: flex;
            gap: 12px;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            minlength: 2;
        }
        
        input[type="text"]:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        /* Главная страница */
        .welcome-container {
            text-align: center;
            padding: 40px 20px;
        }
        
        .welcome-title {
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 20px;
        }
        
        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--gray);
            margin-bottom: 30px;
        }
        
        /* Шапка игрока */
        .player-banner {
            height: 150px;
            background: linear-gradient(135deg, #3498db, #2c3e50);
            border-radius: 10px;
            margin-bottom: -60px;
            position: relative;
            z-index: 1;
            display: none;
        }
        
        .stats-container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: none;
            animation: fadeIn 0.4s ease-out;
            position: relative;
            z-index: 2;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .player-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .player-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .player-tab {
            padding: 10px 15px;
            background-color: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid var(--light-gray);
        }
        
        .player-tab:hover {
            background-color: var(--light);
        }
        
        .player-tab.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .stat-item {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }
        
        .stat-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .stat-label {
            font-weight: 500;
            color: var(--dark);
        }
        
        .stat-value {
            color: var(--dark);
            font-weight: 400;
        }
        
        .online {
            color: var(--success);
        }
        
        .offline {
            color: var(--danger);
        }
        
        .loading {
            text-align: center;
            display: none;
            margin: 30px 0;
            color: var(--gray);
        }
        
        .loading:after {
            content: '...';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        .error {
            color: var(--danger);
            text-align: center;
            margin: 30px 0;
            display: none;
            font-weight: 500;
        }
        
        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-right: 20px;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .avatar.online {
            box-shadow: 0 0 10px 3px rgba(46, 204, 113, 0.5);
            animation: pulse-green 2s infinite;
        }
        
        .avatar.offline {
            box-shadow: 0 0 10px 3px rgba(231, 76, 60, 0.5);
            animation: pulse-red 2s infinite;
        }
        
        @keyframes pulse-green {
            0% { box-shadow: 0 0 5px 2px rgba(46, 204, 113, 0.5); }
            50% { box-shadow: 0 0 15px 5px rgba(46, 204, 113, 0.8); }
            100% { box-shadow: 0 0 5px 2px rgba(46, 204, 113, 0.5); }
        }
        
        @keyframes pulse-red {
            0% { box-shadow: 0 0 5px 2px rgba(231, 76, 60, 0.5); }
            50% { box-shadow: 0 0 15px 5px rgba(231, 76, 60, 0.8); }
            100% { box-shadow: 0 0 5px 2px rgba(231, 76, 60, 0.5); }
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
        }
        
        .player-name-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .player-name {
            font-weight: 500;
            font-size: 1.7rem;
            margin: 5px 0;
            color: var(--dark);
        }
        
        .player-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .player-rank-container {
            margin-bottom: 4px;
        }
        
        .player-rank {
            font-size: 15px;
            font-weight: 500;
            padding: 2px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        /* Блоки в сайдбаре */
        .sidebar-block {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark);
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .moderator-item, .top-player, .stream-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
        }
        
        .moderator-item:last-child, 
        .top-player:last-child, 
        .stream-item:last-child {
            border-bottom: none;
        }
        
        .moderator-avatar, 
        .top-avatar, 
        .stream-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }
        
        .moderator-name, 
        .top-name, 
        .stream-name {
            font-weight: 500;
        }
        
        .moderator-rank {
            font-size: 0.8rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 5px;
        }
        
        .top-rank {
            font-size: 0.8rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 5px;
            background-color: var(--light);
        }
        
        .stream-game {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .no-moderators {
            color: var(--gray);
            text-align: center;
            padding: 20px 0;
            font-style: italic;
        }
        
        /* Градиенты для рангов */
        .rank-PLAYER {
            background: #95a5a6;
            color: white;
        }
        .rank-VIP {
            background: linear-gradient(90deg, #54fc54, #2ecc71);
            color: white;
        }
        .rank-PREMIUM {
            background: linear-gradient(90deg, #7fbfff, #c2e0ff);
            color: #2c3e50;
        }
        .rank-HOLY {
            background: linear-gradient(90deg, #f39c12, #e67e22);
            color: white;
        }
        .rank-IMMORTAL {
            background: linear-gradient(90deg, #ff9ff3, #f368e0);
            color: white;
        }
        .rank-DIVINE {
            background: linear-gradient(90deg, #a569bd, #8e44ad);
            color: white;
        }
        .rank-THANE {
            background: linear-gradient(90deg, #1dd1a1, #10ac84);
            color: white;
        }
        .rank-ELITE {
            background: linear-gradient(90deg, #ff9f43, #ff6b6b);
            color: white;
        }
        .rank-ETERNAL {
            background: linear-gradient(90deg, #f368e0, #9b59b6);
            color: white;
        }
        .rank-JRBUILDER, .rank-BUILDER, .rank-SRBUILDER, .rank-MAPLEAD {
            background: linear-gradient(90deg, #1dd1a1, #10ac84);
            color: white;
        }
        .rank-YOUTUBE {
            background: linear-gradient(90deg, #5f27cd, #341f97);
            color: white;
        }
        .rank-DEV {
            background: linear-gradient(90deg, #ee5253, #b33939);
            color: white;
        }
        .rank-VIME {
            background: linear-gradient(90deg, #0abde3, #01a3a4);
            color: white;
        }
        .rank-ORGANIZER {
            background: linear-gradient(90deg, #0abde3, #0088a3);
            color: white;
        }
        .rank-HELPER {
            background: linear-gradient(90deg, #48dbfb, #0abde3);
            color: white;
        }
        .rank-MODER {
            background: linear-gradient(90deg, #2e86de, #1b6ca8);
            color: white;
        }
        .rank-WARDEN {
            background: linear-gradient(90deg, #1b6ca8, #0a3d62);
            color: white;
        }
        .rank-CHIEF {
            background: linear-gradient(90deg, #ff6b6b, #ee5253);
            color: white;
        }
        .rank-ADMIN {
            background: linear-gradient(90deg, #ee5253, #b33939);
            color: white;
        }
        
        .prime-icon {
            font-size: 1.3em;
            margin-left: 5px;
        }
        
        .prime-badge {
            font-size: 13px;
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning);
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
            margin-left: 8px;
        }
        
        .player-id {
            font-size: 13px;
            color: var(--gray);
        }
        
        .status-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 6px;
        }

        /* Компактный поиск */
        .compact-search {
            position: fixed;
            right: 20px;
            top: 20px;
            z-index: 80;
            display: none;
        }

        .compact-search-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .compact-search-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .compact-search-container {
            position: absolute;
            right: 0;
            top: 60px;
            width: 300px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: none;
        }

        .compact-search-form {
            display: flex;
            gap: 10px;
        }

        .compact-search-input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .compact-search-input:focus {
            border-color: var(--primary);
            outline: none;
        }

        .compact-search-submit {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .compact-search-submit:hover {
            background-color: var(--primary-hover);
        }
        
        /* Блоки статистики */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .game-stats {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .game-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-gray);
            color: var(--dark);
        }
        
        .game-stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .game-stat-label {
            color: var(--gray);
        }
        
        .game-stat-value {
            font-weight: 500;
            color: var(--dark);
        }
        
        .player-status-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .player-level-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .level-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .level-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .exp-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .exp-progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .exp-text {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 3px;
            text-align: right;
        }
        
        .profile-content {
            display: none;
        }
        
        .profile-content.active {
            display: block;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Выдвигающееся меню -->
    <div class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <div class="menu-overlay" id="menuOverlay"></div>
    
    <div class="side-menu" id="sideMenu">
        <div class="menu-tabs">
            <div class="menu-tab active" data-tab="moderators">
                <i class="fas fa-shield-alt"></i> Модераторы онлайн
            </div>
            <div class="menu-tab" data-tab="tops">
                <i class="fas fa-trophy"></i> Топ игроков
            </div>
            <div class="menu-tab" data-tab="streams">
                <i class="fas fa-video"></i> Стримы сейчас
            </div>
        </div>
        
        <div class="menu-content active" id="moderatorsContent">
            <div class="sidebar-block">
                <h3 class="sidebar-title">Модераторы онлайн</h3>
                <div id="moderatorsList">
                    <div class="loading">Загрузка модераторов...</div>
                </div>
            </div>
        </div>
        
        <div class="menu-content" id="topsContent">
            <div class="sidebar-block">
                <h3 class="sidebar-title">Топ игроков</h3>
                <div class="top-player">
                    <img src="https://skin.vimeworld.ru/head/Top1.png" class="top-avatar">
                    <span class="top-name">Legend</span>
                    <span class="top-rank rank-ADMIN">#1</span>
                </div>
                <div class="top-player">
                    <img src="https://skin.vimeworld.ru/head/Top2.png" class="top-avatar">
                    <span class="top-name">ProPlayer</span>
                    <span class="top-rank rank-DIVINE">#2</span>
                </div>
                <div class="top-player">
                    <img src="https://skin.vimeworld.ru/head/Top3.png" class="top-avatar">
                    <span class="top-name">Streamer</span>
                    <span class="top-rank rank-YOUTUBE">#3</span>
                </div>
            </div>
        </div>
        
        <div class="menu-content" id="streamsContent">
            <div class="sidebar-block">
                <h3 class="sidebar-title">Стримы сейчас</h3>
                <div class="stream-item">
                    <img src="https://skin.vimeworld.ru/head/Streamer1.png" class="stream-avatar">
                    <div>
                        <div class="stream-name">GameMaster</div>
                        <div class="stream-game">Murder Mystery</div>
                    </div>
                </div>
                <div class="stream-item">
                    <img src="https://skin.vimeworld.ru/head/Streamer2.png" class="stream-avatar">
                    <div>
                        <div class="stream-name">BuildExpert</div>
                        <div class="stream-game">Build Battle</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="main-content">
        <div id="welcomeScreen">
            <div class="welcome-container">
                <h2 class="welcome-title">Добро пожаловать на VimeFur</h2>
                <p class="welcome-subtitle">Лучший источник статистики по игрокам VimeWorld</p>
                
                <div class="search-container">
                    <form class="search-form" id="playerForm">
                        <input type="text" id="username" placeholder="Введите ник игрока" required minlength="2">
                        <button type="submit">Найти</button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="player-banner" id="playerBanner"></div>
        
        <div class="loading" id="loading">
            <p>Загрузка данных игрока</p>
        </div>
        
        <div class="error" id="error">
            Игрок не найден. Проверьте правильность написания ника.
        </div>
        
        <div class="stats-container" id="statsContainer">
            <div class="player-header">
                <img id="playerAvatar" src="" alt="Аватар" class="avatar" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEyLDJBMTAsMTAgMCAwLDAgMiwxMkExMCwxMCAwIDAsMCAxMiwyMkExMCwxMCAwIDAsMCAyMiwxMkExMCwxMCAwIDAsMCAxMiwyTTEyLDRBNyw3IDAgMCwxIDE5LDExQTcsNyAwIDAsMSAxMiwxOEE3LDcgMCAwLDEgNSwxMVE3LDcgMCAwLDEgMTIsNE0xMiw2QTUsNSAwIDAsMCA3LDExQTUsNSAwIDAsMCAxMiwxNkE1LDUgMCAwLDAgMTcsMTFBNSw1IDAgMCwwIDEyLDZNNiwxMUE2LDYgMCAwLDEgMTIsNUE2LDYgMCAwLDEgMTgsMTFBNiw2IDAgMCwxIDEyLDE3QTYsNiAwIDAsMSA2LDExWiIgZmlsbD0iIzJjM2U1MCIvPjwvc3ZnPg=='">
                <div class="player-info">
                    <div class="player-rank-container">
                        <span id="playerRank" class="player-rank"></span>
                        <span id="primeBadge" class="prime-badge" style="display: none;">Prime</span>
                    </div>
                    <div class="player-name-container">
                        <span id="playerName" class="player-name"></span>
                        <span id="primeIcon" class="prime-icon" style="display: none;"></span>
                    </div>
                    <div class="player-meta">
                        <div id="playerId" class="player-id"></div>
                    </div>
                </div>
            </div>
            
            <div class="player-level-container">
                <div class="level-label">Уровень: <span id="playerLevel" class="level-value"></span></div>
                <div class="exp-bar">
                    <div id="expProgress" class="exp-progress" style="width: 0%"></div>
                </div>
                <div id="expText" class="exp-text">0% до следующего уровня</div>
            </div>
            
            <div class="player-tabs">
                <div class="player-tab active" data-tab="profile">Профиль</div>
                <div class="player-tab" data-tab="matches">Матчи</div>
                <div class="player-tab" data-tab="skin">Скин</div>
                <div class="player-tab" data-tab="friends">Друзья</div>
                <div class="player-tab" data-tab="achievements">Достижения</div>
                <div class="player-tab" data-tab="guild">Гильдия</div>
            </div>
            
            <div class="profile-content active" id="profileContent">
                <div class="stats-grid" id="statsGrid">
                    <!-- Здесь будет динамически загружаться статистика -->
                </div>
            </div>
            
            <div class="profile-content" id="matchesContent">
                <div class="loading">Раздел в разработке</div>
            </div>
            
            <div class="profile-content" id="skinContent">
                <div class="loading">Раздел в разработке</div>
            </div>
            
            <div class="profile-content" id="friendsContent">
                <div class="loading">Раздел в разработке</div>
            </div>
            
            <div class="profile-content" id="achievementsContent">
                <div class="loading">Раздел в разработке</div>
            </div>
            
            <div class="profile-content" id="guildContent">
                <div class="loading">Раздел в разработке</div>
            </div>
        </div>
    </div>
    
    <!-- Компактный поиск -->
    <div class="compact-search" id="compactSearch">
        <button class="compact-search-btn" id="compactSearchBtn">
            <i class="fas fa-search"></i>
        </button>
        <div class="compact-search-container" id="compactSearchContainer">
            <form class="compact-search-form" id="compactSearchForm">
                <input type="text" class="compact-search-input" id="compactSearchInput" placeholder="Ник игрока" required minlength="2">
                <button type="submit" class="compact-search-submit">Найти</button>
            </form>
        </div>
    </div>
    
    <script>
        // Управление выдвижным меню
        const menuToggle = document.getElementById('menuToggle');
        const menuOverlay = document.getElementById('menuOverlay');
        const sideMenu = document.getElementById('sideMenu');
        
        menuToggle.addEventListener('click', function() {
            sideMenu.classList.toggle('active');
            menuOverlay.classList.toggle('active');
            this.classList.toggle('active');
            
            // Добавляем/убираем overflow: hidden для body при открытии/закрытии меню
            if (sideMenu.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        });
        
        menuOverlay.addEventListener('click', function() {
            sideMenu.classList.remove('active');
            menuOverlay.classList.remove('active');
            menuToggle.classList.remove('active');
            document.body.style.overflow = ''; // Возвращаем стандартное поведение прокрутки
        });
        
        // Переключение вкладок в меню
        const menuTabs = document.querySelectorAll('.menu-tab');
        menuTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Убираем активный класс у всех вкладок и контента
                menuTabs.forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.menu-content').forEach(c => c.classList.remove('active'));
                
                // Добавляем активный класс текущей вкладке и соответствующему контенту
                this.classList.add('active');
                document.getElementById(tabId + 'Content').classList.add('active');
                
                // Если открыта вкладка модераторов, обновляем список
                if (tabId === 'moderators') {
                    loadModerators();
                }
            });
        });
        
        // Переключение вкладок профиля
        const playerTabs = document.querySelectorAll('.player-tab');
        playerTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Убираем активный класс у всех вкладок и контента
                playerTabs.forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.profile-content').forEach(c => c.classList.remove('active'));
                
                // Добавляем активный класс текущей вкладке и соответствующему контенту
                this.classList.add('active');
                document.getElementById(tabId + 'Content').classList.add('active');
            });
        });
        
        // Поиск игрока
        document.getElementById('playerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            
            if (username.length >= 2) {
                document.getElementById('compactSearch').style.display = 'none';
                fetchPlayerStats(username);
            }
        });
        
        // Управление компактным поиском
        const compactSearch = document.getElementById('compactSearch');
        const compactSearchBtn = document.getElementById('compactSearchBtn');
        const compactSearchContainer = document.getElementById('compactSearchContainer');
        const compactSearchForm = document.getElementById('compactSearchForm');
        const compactSearchInput = document.getElementById('compactSearchInput');

        compactSearchBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            compactSearchContainer.style.display = compactSearchContainer.style.display === 'block' ? 'none' : 'block';
        });

        compactSearchForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const username = compactSearchInput.value.trim();
            
            if (username.length >= 2) {
                fetchPlayerStats(username);
                compactSearchContainer.style.display = 'none';
            }
        });

        // Закрытие при клике вне области поиска
        document.addEventListener('click', function(e) {
            if (!compactSearch.contains(e.target)) {
                compactSearchContainer.style.display = 'none';
            }
        });
        
        // Загрузка модераторов онлайн
        function loadModerators() {
            const moderatorsList = document.getElementById('moderatorsList');
            moderatorsList.innerHTML = '<div class="loading">Загрузка модераторов...</div>';
            
            fetch('https://api.vimeworld.com/online/staff')
                .then(response => {
                    if (!response.ok) throw new Error('API error');
                    return response.json();
                })
                .then(data => {
                    // Фильтруем только нужные ранги
                    const allowedRanks = ['HELPER', 'MODER', 'WARDEN', 'CHIEF', 'ADMIN'];
                    const moderators = data.filter(user => allowedRanks.includes(user.rank));
                    
                    if (moderators.length === 0) {
                        moderatorsList.innerHTML = '<div class="no-moderators">Модераторы не в сети 😢</div>';
                        return;
                    }
                    
                    // Сортируем по рангу (от высшего к низшему)
                    const rankOrder = ['ADMIN', 'CHIEF', 'WARDEN', 'MODER', 'HELPER'];
                    moderators.sort((a, b) => rankOrder.indexOf(a.rank) - rankOrder.indexOf(b.rank));
                    
                    // Очищаем список и добавляем модераторов
                    moderatorsList.innerHTML = '';
                    
                    moderators.forEach(moderator => {
                        const rankNames = {
                            'HELPER': 'Хелпер',
                            'MODER': 'Модератор',
                            'WARDEN': 'Пр. Модератор',
                            'CHIEF': 'Админ',
                            'ADMIN': 'Гл. Админ'
                        };
                        
                        const rankName = rankNames[moderator.rank] || moderator.rank;
                        const rankClass = `rank-${moderator.rank}`;
                        
                        const moderatorElement = document.createElement('div');
                        moderatorElement.className = 'moderator-item';
                        moderatorElement.innerHTML = `
                            <img src="https://skin.vimeworld.ru/head/${moderator.username}.png" class="moderator-avatar" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEyLDJBMTAsMTAgMCAwLDAgMiwxMkExMCwxMCAwIDAsMCAxMiwyMkExMCwxMCAwIDAsMCAyMiwxMkExMCwxMCAwIDAsMCAxMiwyTTEyLDRBNyw3IDAgMCwxIDE5LDExQTcsNyAwIDAsMSAxMiwxOEE3LDcgMCAwLDEgNSwxMVE3LDcgMCAwLDEgMTIsNE0xMiw2QTUsNSAwIDAsMCA3LDExQTUsNSAwIDAsMCAxMiwxNkE1LDUgMCAwLDAgMTcsMTFBNSw1IDAgMCwwIDEyLDZNNiwxMUE2LDYgMCAwLDEgMTIsNUE2LDYgMCAwLDEgMTgsMTFBNiw2IDAgMCwxIDEyLDE3QTYsNiAwIDAsMSA2LDExWiIgZmlsbD0iIzJjM2U1MCIvPjwvc3ZnPg=='">
                            <span class="moderator-name">${moderator.username}</span>
                            <span class="moderator-rank ${rankClass}">${rankName}</span>
                        `;
                        
                        // Добавляем обработчик клика для перехода к статистике игрока
                        moderatorElement.addEventListener('click', () => {
                            fetchPlayerStats(moderator.username);
                            sideMenu.classList.remove('active');
                            menuOverlay.classList.remove('active');
                            menuToggle.classList.remove('active');
                            document.body.style.overflow = '';
                        });
                        
                        moderatorsList.appendChild(moderatorElement);
                    });
                })
                .catch(error => {
                    console.error('Ошибка загрузки модераторов:', error);
                    moderatorsList.innerHTML = '<div class="error">Не удалось загрузить список модераторов</div>';
                });
        }
        
        // Загружаем модераторов при загрузке страницы
        document.addEventListener('DOMContentLoaded', loadModerators);
        
        // Обновляем список модераторов каждые 2 минуты
        setInterval(loadModerators, 120000);
        
        function fetchPlayerStats(username) {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('statsContainer').style.display = 'none';
            document.getElementById('playerBanner').style.display = 'none';
            
            Promise.all([
                fetch(`https://api.vimeworld.ru/user/name/${username}`)
                    .then(res => {
                        if (!res.ok) throw new Error('API error');
                        return res.json();
                    }),
                fetch(`https://api.vimeworld.ru/user/name/${username}/session`)
                    .then(res => {
                        if (!res.ok) throw new Error('API error');
                        return res.json();
                    }),
                fetch(`https://api.vimeworld.com/user/name/${username}/stats`)
                    .then(res => {
                        if (!res.ok) throw new Error('API error');
                        return res.json();
                    })
            ])
            .then(([userData, sessionData, statsData]) => {
                if (!userData || userData.length === 0) {
                    throw new Error('Игрок не найден');
                }
                
                const player = userData[0];
                const session = sessionData || {};
                displayPlayerStats(player, session, statsData);
            })
            .catch(error => {
                console.error('Ошибка:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            });
        }
        
        function isValidColor(color) {
            return /^[0-9A-Fa-f]{3,6}$/i.test(color);
        }
        
        function displayPlayerStats(player, session, stats) {
            // Показываем компактный поиск
            document.getElementById('compactSearch').style.display = 'block';
            
            // Скрываем приветственный экран
            document.getElementById('welcomeScreen').style.display = 'none';
            
            // Показываем баннер
            document.getElementById('playerBanner').style.display = 'block';
            
            const playerNameElement = document.getElementById('playerName');
            playerNameElement.textContent = player.username;

            // Применяем кастомные цвета к никнейму
            if (player.customColors && player.customColors.length > 0) {
                const validColors = player.customColors.filter(c => isValidColor(c));
                
                if (validColors.length > 0) {
                    const gradientColors = validColors.map(color => `#${color.length === 3 ? 
                        color.split('').map(c => c+c).join('') : color}`);
                    
                    if (gradientColors.length === 1) {
                        playerNameElement.style.color = gradientColors[0];
                        playerNameElement.style.background = 'none';
                        playerNameElement.style.removeProperty('background-image');
                        playerNameElement.style.removeProperty('-webkit-background-clip');
                        playerNameElement.style.removeProperty('background-clip');
                    } else {
                        let gradientStops = '';
                        const step = 100 / (gradientColors.length - 1);
                        for (let i = 0; i < gradientColors.length; i++) {
                            gradientStops += `${gradientColors[i]} ${i * step}%`;
                            if (i < gradientColors.length - 1) gradientStops += ', ';
                        }
                        
                        playerNameElement.style.background = 'none';
                        playerNameElement.style.color = 'transparent';
                        playerNameElement.style.backgroundImage = `linear-gradient(90deg, ${gradientStops})`;
                        playerNameElement.style.webkitBackgroundClip = 'text';
                        playerNameElement.style.backgroundClip = 'text';
                    }
                } else {
                    resetNameStyles(playerNameElement);
                }
            } else {
                resetNameStyles(playerNameElement);
            }
            
            function resetNameStyles(element) {
                element.style.background = 'none';
                element.style.color = 'var(--dark)';
                element.style.removeProperty('background-image');
                element.style.removeProperty('-webkit-background-clip');
                element.style.removeProperty('background-clip');
            }
            
            const avatar = document.getElementById('playerAvatar');
            avatar.src = `https://skin.vimeworld.ru/head/${player.username}.png`;
            
            // Подсветка аватара в зависимости от статуса
            if (session.online && session.online.value) {
                avatar.classList.add('online');
                avatar.classList.remove('offline');
            } else {
                avatar.classList.add('offline');
                avatar.classList.remove('online');
            }
            
            // Обработка ранга и Prime статуса
            const rankElement = document.getElementById('playerRank');
            const primeBadge = document.getElementById('primeBadge');
            const primeIcon = document.getElementById('primeIcon');
            
            // Словарь для преобразования рангов
            const rankNames = {
                'PLAYER': 'Игрок',
                'VIP': 'VIP',
                'PREMIUM': 'Premium',
                'HOLY': 'Holy',
                'IMMORTAL': 'Immortal',
                'DIVINE': 'Divine',
                'THANE': 'Thane',
                'ELITE': 'Elite',
                'ETERNAL': 'Eternal',
                'JRBUILDER': 'Мл. Билдер',
                'BUILDER': 'Билдер',
                'SRBUILDER': 'Ст. Билдер',
                'MAPLEAD': 'Гл. Билдер',
                'YOUTUBE': 'Media',
                'DEV': 'Разработчик',
                'VIME': 'Vime',
                'ORGANIZER': 'Организатор',
                'HELPER': 'Хелпер',
                'MODER': 'Модератор',
                'WARDEN': 'Пр. Модератор',
                'CHIEF': 'Админ',
                'ADMIN': 'Гл. Админ'
            };
            
            const rankClass = player.rank ? `rank-${player.rank.toUpperCase()}` : 'rank-PLAYER';
            const rankName = rankNames[player.rank?.toUpperCase()] || 'Игрок';
            
            rankElement.textContent = rankName;
            rankElement.className = `player-rank ${rankClass}`;
            
            // Обработка Prime иконки с поддержкой всех цветов
            if (player.prime === true) {
                primeBadge.style.display = 'inline-block';
                
                if (player.primeIcon && typeof player.primeIcon === 'string') {
                    const colorMap = {
                        '0': '#000000', // черный
                        '1': '#0000AA', // темно-синий
                        '2': '#00AA00', // темно-зеленый
                        '3': '#00AAAA', // темно-бирюзовый
                        '4': '#AA0000', // темно-красный
                        '5': '#AA00AA', // фиолетовый
                        '6': '#FFAA00', // золотой
                        '7': '#AAAAAA', // серый
                        '8': '#555555', // темно-серый
                        '9': '#5555FF', // синий
                        'a': '#55FF55', // зеленый
                        'b': '#55FFFF', // бирюзовый
                        'c': '#FF5555', // красный
                        'd': '#FF55FF', // розовый
                        'e': '#FFFF55', // желтый
                        'f': '#FFFFFF'  // белый
                    };
                    
                    const match = player.primeIcon.match(/&([0-9a-f])(.*)/);
                    if (match) {
                        const colorCode = match[1].toLowerCase();
                        const symbol = match[2];
                        primeIcon.textContent = symbol;
                        primeIcon.style.color = colorMap[colorCode] || '#f39c12';
                        primeIcon.style.display = 'inline';
                    } else {
                        primeIcon.textContent = player.primeIcon;
                        primeIcon.style.color = '#f39c12';
                        primeIcon.style.display = 'inline';
                    }
                } else {
                    primeIcon.style.display = 'none';
                }
            } else {
                primeBadge.style.display = 'none';
                primeIcon.style.display = 'none';
            }
            
            // ID игрока
            document.getElementById('playerId').textContent = `id: ${player.id}`;
            
            // Уровень игрока и прогресс
            const levelElement = document.getElementById('playerLevel');
            const expProgress = document.getElementById('expProgress');
            const expText = document.getElementById('expText');
            
            levelElement.textContent = player.level !== undefined ? player.level : '0';
            
            const percentage = player.levelPercentage !== undefined ? 
                Math.round(player.levelPercentage * 100) : 0;
            
            expProgress.style.width = `${percentage}%`;
            expText.textContent = `${percentage}% до следующего уровня`;
            
            // Загружаем статистику по играм
            displayGameStats(stats);
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('statsContainer').style.display = 'block';
            
            // Обновляем основной поиск
            document.getElementById('username').value = player.username;
            compactSearchInput.value = player.username;
        }
        
        // Отображение статистики по играм
        function displayGameStats(stats) {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = '';
            
            if (!stats || !stats.stats) {
                statsGrid.innerHTML = '<div class="error">Статистика не найдена</div>';
                return;
            }
            
            // Словарь с названиями игр и их статистикой
            const games = {
                'ANN': {
                    name: 'Annihilation',
                    stats: [
                        { label: 'Ударов по базе', key: 'nexus' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Убийств с лука', key: 'bowkills' },
                        { label: 'Добыто дуба', key: 'wood' },
                        { label: 'Добыто руды', key: 'ores' },
                        { label: 'Добыто земли', key: 'digged' }
                    ]
                },
                'BP': {
                    name: 'BlockParty',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Игр сыграно', key: 'games' },
                        { label: 'Пройдено раундов', key: 'rounds' },
                        { label: 'Очков', key: 'points' }
                    ]
                },
                'BW': {
                    name: 'BedWars',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' },
                        { label: 'Разрушено кроватей', key: 'beds' }
                    ]
                },
                'CR': {
                    name: 'CrystalRush',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' },
                        { label: 'Кристаллов', key: 'crystals' }
                    ]
                },
                'DEATHRUN': {
                    name: 'Death Run',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' },
                        { label: 'Активаций', key: 'activations' }
                    ]
                },
                'EGGWARS': {
                    name: 'Egg Wars',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' },
                        { label: 'Разрушено яиц', key: 'eggs' }
                    ]
                },
                'HG': {
                    name: 'HungerGames',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Игр сыграно', key: 'games' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' }
                    ]
                },
                'MURDER': {
                    name: 'Murder Mystery',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Игр сыграно', key: 'games' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' }
                    ]
                },
                'SW': {
                    name: 'Sky Wars',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' }
                    ]
                },
                'BRIDGE': {
                    name: 'Bridge',
                    stats: [
                        { label: 'Побед', key: 'wins' },
                        { label: 'Поражений', key: 'loses' },
                        { label: 'Убийств', key: 'kills' },
                        { label: 'Смертей', key: 'deaths' },
                        { label: 'Очков', key: 'points' }
                    ]
                }
            };
            
            // Создаем блоки статистики для каждой игры
            for (const [gameId, gameData] of Object.entries(games)) {
                if (stats.stats[gameId] && stats.stats[gameId].global) {
                    const gameStats = stats.stats[gameId].global;
                    const gameElement = document.createElement('div');
                    gameElement.className = 'game-stats';
                    
                    let statsHTML = `<div class="game-title">${gameData.name}</div>`;
                    
                    gameData.stats.forEach(stat => {
                        const value = gameStats[stat.key] || 0;
                        statsHTML += `
                            <div class="game-stat-item">
                                <span class="game-stat-label">${stat.label}:</span>
                                <span class="game-stat-value">${value}</span>
                            </div>
                        `;
                    });
                    
                    gameElement.innerHTML = statsHTML;
                    statsGrid.appendChild(gameElement);
                }
            }
            
            // Если нет статистики ни по одной игре
            if (statsGrid.children.length === 0) {
                statsGrid.innerHTML = '<div class="error">Нет статистики по играм</div>';
            }
        }
        
        // Обработка кликов по вкладкам
        document.querySelectorAll('.player-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.player-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                const tabId = this.getAttribute('data-tab');
                document.querySelectorAll('.profile-content').forEach(c => c.classList.remove('active'));
                document.getElementById(tabId + 'Content').classList.add('active');
            });
        });
    </script>
</body>
</html>